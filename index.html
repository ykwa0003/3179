<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Melbourne Metropolitan Train Station Entries, FY2024–25</title>

  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; padding: 24px; background: #fafafa; }
    h1 { font-weight: 600; font-size: 20px; margin: 0 0 8px 0; }
    p  { margin: 0 0 18px 0; color: #444; }
    .vis-wrap { max-width: 980px; margin: 0 auto; background: #fff; padding: 16px; border-radius: 12px; box-shadow: 0 2px 20px rgba(0,0,0,.06); }
    #vis { width: 100%; }
    .note { font-size: 13px; color: #666; margin-top: 10px; }
  </style>
</head>

<body>
  <div class="vis-wrap">
    <h1>Annual Passenger Entries at Melbourne Train Stations, FY2024–25</h1>
    <p>Circle size shows annual entries, colour shows average weekday entries</p>
    <div id="vis"></div>
    <div class="note">Data: data.vic.gov.au &amp; Natural Earth Data</div>
  </div>

  <script>
    const spec = {
      $schema: "https://vega.github.io/schema/vega-lite/v5.json",
      width: 940,
      height: 600,
      config: { view: { stroke: null }, legend: { orient: "right" }, axis: { grid: false } },

      "projection": {
        "type": "mercator",
        "center": [145.0, -37.8], 
        "scale": 35000,
        "translate": [470, 300]
        },
        
      layer: [
        {
          data: {
            url: "ne6.json",
            format: { type: "topojson", feature: "ne_50m_admin_1_states_provinces" }
          },
          mark: { type: "geoshape", fill: "#ececec", stroke: "#bdbdbd", strokeWidth: 0.6 }
        },

        {
        data: {
            url: "ne6.json",
            format: { type: "topojson", feature: "ne_10m_graticules_1" }
        },
        mark: { type: "geoshape", stroke: "#999999", strokeWidth: 0.5 }
        },

        {
          data: { url: "stations_vic.csv", format: { type: "csv" } },
          transform: [{ filter: "isValid(datum.Stop_long) && isValid(datum.Stop_lat)" }],
          mark: { type: "circle", opacity: 0.85, stroke: "#1a1a1a", strokeWidth: 0.2, tooltip: { content: "data" } },
          encoding: {
            longitude: { field: "Stop_long", type: "quantitative" },
            latitude: { field: "Stop_lat", type: "quantitative" },
            size: {
              field: "Pax_annual",
              type: "quantitative",
              title: "Annual entries",
              scale: { range: [20, 1200] }
            },
            color: {
              field: "Pax_weekday",
              type: "quantitative",
              title: "Weekday average",
              scale: { scheme: "blues" }
            },
            tooltip: [
              { field: "Stop_name", title: "Station" },
              { field: "Pax_annual", title: "Annual entries" },
              { field: "Pax_weekday", title: "Weekday average" },
              { field: "Pax_Saturday", title: "Saturday average" },
              { field: "Pax_Sunday", title: "Sunday average" }
            ]
          }
        }
      ]
    };

    vegaEmbed("#vis", spec, { actions: false });
  </script>
</body>
</html>
